[buildout]
extends =
    base.cfg
    sources.cfg

parts +=
    i18ndude
    omelette
    tags
    test
    zopeskel
    paster
    redis
    redis_cleanup
    queueprocessor

sources = sources
auto-checkout = *
always-checkout = force

[instance]
debug-mode = on
verbose-security = on
eggs +=
    plone.reload
    Products.PDBDebugMode
    collective.monkeypatcher
    plone.tinymceplugins.mathquill
    collective.googleanalytics

[omelette]
recipe = collective.recipe.omelette
eggs = ${instance:eggs}
packages = ./

[test]
recipe = collective.xmltestreport
eggs =
    ${instance:eggs}
    collective.topictree [test]
    emas.theme [test]
    emas.transforms [test]
    rhaptos.xmlfile [test]
    rhaptos.compilation [test]
    Products.CMFQuickInstallerTool [test]
defaults = ['--exit-with-status', '--auto-color', '--auto-progress',
    '--verbose', '--ndiff']

[tags]
recipe = z3c.recipe.tag:tags
eggs = ${instance:eggs}

[i18ndude]
unzip = true
recipe = zc.recipe.egg
eggs = i18ndude

[zopeskel]
unzip = true
recipe = zc.recipe.egg
eggs =
    ZopeSkel
    Paste
    PasteDeploy
    PasteScript
    zopeskel.dexterity<=2.99
    ${instance:eggs}

[paster]
recipe = zc.recipe.egg
eggs =
    PasteScript
    gomobile.templates
    ${instance:eggs}

[redis]
recipe = hexagonit.recipe.cmmi
url = http://redis.googlecode.com/files/redis-2.4.16.tar.gz
configure-command = echo No configure for redis
make-options = PREFIX=${buildout:directory}

[redis_cleanup]
recipe = collective.recipe.cmd
on_install = true
on_update = true
cmds = rm -rf ${redis:compile-directory}

[queueprocessor]
recipe = zc.recipe.egg
eggs = upfrontsystems.q
scripts = processqueue
entry-points = processqueue=upfrontsystems.q.scripts.queueprocessor:processqueue
